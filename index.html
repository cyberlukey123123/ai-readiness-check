<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>AI Readiness Check | QuantiveCyber</title>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700;800&display=swap" rel="stylesheet">
    <style>
        *, *::before, *::after {
            box-sizing: border-box;
            margin: 0;
            padding: 0;
        }

        :root {
            --ink: #1a1a1a;
            --ink-mid: #555555;
            --ink-light: #888888;
            --bg: #f7f8f9;
            --white: #ffffff;
            --accent: #0ea5e9;
            --accent-dark: #0284c7;
            --green: #10b981;
            --red: #ef4444;
            --orange: #f59e0b;
            --border: #e2e4e8;
        }

        body {
            font-family: 'Inter', -apple-system, BlinkMacSystemFont, 'Segoe UI', sans-serif;
            background: var(--bg);
            color: var(--ink);
            line-height: 1.5;
            font-weight: 400;
        }

        /* Header */
        .header {
            background: var(--white);
            border-bottom: 1px solid var(--border);
            padding: 18px 0;
        }

        .header-inner {
            max-width: 1080px;
            margin: 0 auto;
            padding: 0 24px;
            display: flex;
            align-items: center;
            gap: 18px;
        }

        .logo {
            height: 54px;
        }

        .brand-info {
            padding-left: 18px;
            border-left: 2px solid var(--border);
        }

        .brand-name {
            font-size: 1.375rem;
            font-weight: 700;
            color: var(--ink);
            letter-spacing: -0.3px;
        }

        .brand-tagline {
            font-size: 0.8125rem;
            font-weight: 400;
            color: var(--ink-light);
        }

        /* Hero */
        .hero {
            background: var(--white);
            padding: 44px 24px 52px;
            text-align: center;
            border-bottom: 1px solid var(--border);
        }

        .hero h1 {
            font-size: 2.75rem;
            font-weight: 800;
            letter-spacing: -1px;
            color: var(--ink);
            margin-bottom: 10px;
        }

        .hero p {
            font-size: 1.0625rem;
            font-weight: 400;
            color: var(--ink-mid);
            max-width: 520px;
            margin: 0 auto;
        }

        .container {
            max-width: 800px;
            margin: 0 auto;
            padding: 36px 24px 60px;
        }

        /* Progress Bar */
        .progress-container {
            background: var(--border);
            border-radius: 10px;
            height: 8px;
            margin-bottom: 30px;
            overflow: hidden;
        }

        .progress-bar {
            height: 100%;
            background: var(--accent);
            border-radius: 10px;
            transition: width 0.4s ease;
            width: 0%;
        }

        .progress-text {
            text-align: center;
            font-size: 0.875rem;
            font-weight: 500;
            color: var(--ink-light);
            margin-bottom: 20px;
        }

        /* Question Card */
        .question-card {
            background: var(--white);
            border: 1px solid var(--border);
            border-radius: 16px;
            padding: 30px;
            margin-bottom: 20px;
            display: none;
        }

        .question-card.active {
            display: block;
            animation: fadeIn 0.4s ease;
        }

        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(10px); }
            to { opacity: 1; transform: translateY(0); }
        }

        .category-badge {
            display: inline-block;
            background: rgba(14, 165, 233, 0.1);
            color: var(--accent);
            padding: 5px 12px;
            border-radius: 6px;
            font-size: 0.75rem;
            font-weight: 600;
            text-transform: uppercase;
            letter-spacing: 0.5px;
            margin-bottom: 15px;
        }

        .question-number {
            font-size: 0.8125rem;
            font-weight: 500;
            color: var(--ink-light);
            margin-bottom: 8px;
        }

        .question-text {
            font-size: 1.25rem;
            font-weight: 700;
            color: var(--ink);
            margin-bottom: 25px;
            line-height: 1.4;
            letter-spacing: -0.3px;
        }

        /* Answer Options */
        .options {
            display: flex;
            flex-direction: column;
            gap: 12px;
        }

        .option {
            background: var(--white);
            border: 2px solid var(--border);
            border-radius: 12px;
            padding: 16px 20px;
            cursor: pointer;
            transition: all 0.2s ease;
            display: flex;
            align-items: center;
            gap: 12px;
        }

        .option:hover {
            background: var(--bg);
            border-color: var(--accent);
        }

        .option.selected {
            background: rgba(14, 165, 233, 0.08);
            border-color: var(--accent);
            box-shadow: 0 0 0 3px rgba(14, 165, 233, 0.1);
        }

        .option-indicator {
            width: 22px;
            height: 22px;
            border-radius: 50%;
            border: 2px solid var(--border);
            display: flex;
            align-items: center;
            justify-content: center;
            flex-shrink: 0;
            transition: all 0.2s ease;
        }

        .option.selected .option-indicator {
            background: var(--accent);
            border-color: var(--accent);
        }

        .option.selected .option-indicator::after {
            content: '✓';
            color: #fff;
            font-size: 12px;
            font-weight: 700;
        }

        .option-text {
            font-size: 0.9375rem;
            font-weight: 500;
            color: var(--ink);
        }

        /* Navigation */
        .nav-buttons {
            display: flex;
            justify-content: space-between;
            margin-top: 30px;
            gap: 15px;
        }

        .btn {
            padding: 14px 26px;
            border-radius: 12px;
            font-family: inherit;
            font-size: 0.875rem;
            font-weight: 700;
            cursor: pointer;
            transition: all 0.2s ease;
            border: none;
        }

        .btn-secondary {
            background: var(--white);
            border: 1px solid var(--border);
            color: var(--ink);
        }

        .btn-secondary:hover {
            background: var(--bg);
        }

        .btn-primary {
            background: var(--accent);
            color: #fff;
            flex: 1;
            max-width: 200px;
        }

        .btn-primary:hover {
            background: var(--accent-dark);
        }

        .btn-primary:disabled {
            opacity: 0.5;
            cursor: not-allowed;
        }

        /* Lead Capture Form */
        .lead-form {
            display: none;
        }

        .lead-form.active {
            display: block;
            animation: fadeIn 0.4s ease;
        }

        .lead-form h2 {
            font-size: 1.5rem;
            font-weight: 700;
            color: var(--ink);
            margin-bottom: 10px;
        }

        .lead-form p {
            color: var(--ink-mid);
            margin-bottom: 25px;
        }

        .form-group {
            margin-bottom: 20px;
        }

        .form-group label {
            display: block;
            font-size: 0.875rem;
            font-weight: 600;
            color: var(--ink);
            margin-bottom: 8px;
        }

        .form-group input, .form-group select {
            width: 100%;
            padding: 12px 14px;
            background: var(--white);
            border: 1px solid var(--border);
            border-radius: 10px;
            color: var(--ink);
            font-family: inherit;
            font-size: 0.9375rem;
            font-weight: 500;
            transition: all 0.2s ease;
        }

        .form-group input:focus, .form-group select:focus {
            outline: none;
            border-color: var(--accent);
            box-shadow: 0 0 0 3px rgba(14, 165, 233, 0.15);
        }

        .form-group input::placeholder {
            color: var(--ink-light);
        }

        .form-row {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 15px;
        }

        @media (max-width: 600px) {
            .form-row {
                grid-template-columns: 1fr;
            }
        }

        /* Results Section */
        .results {
            display: none;
        }

        .results.active {
            display: block;
            animation: fadeIn 0.5s ease;
        }

        .results-header {
            text-align: center;
            margin-bottom: 40px;
        }

        .results-header h2 {
            font-size: 1.8rem;
            font-weight: 700;
            color: var(--ink);
            margin-bottom: 10px;
            letter-spacing: -0.5px;
        }

        .results-header p {
            color: var(--ink-mid);
        }

        .score-display {
            display: flex;
            justify-content: center;
            align-items: center;
            gap: 30px;
            margin: 30px 0;
            flex-wrap: wrap;
        }

        .score-circle {
            width: 180px;
            height: 180px;
            border-radius: 50%;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            position: relative;
            background: var(--white);
            border: 6px solid var(--risk-color);
        }

        .score-circle .score-value {
            font-size: 3.5rem;
            font-weight: 800;
            color: var(--ink);
            letter-spacing: -2px;
        }

        .score-circle .score-label {
            font-size: 0.8125rem;
            font-weight: 500;
            color: var(--ink-light);
        }

        .risk-band {
            padding: 20px 30px;
            border-radius: 12px;
            text-align: center;
            background: var(--white);
            border: 2px solid var(--risk-color);
        }

        .risk-band .risk-label {
            font-size: 0.75rem;
            font-weight: 600;
            text-transform: uppercase;
            letter-spacing: 0.5px;
            color: var(--ink-light);
            margin-bottom: 5px;
        }

        .risk-band .risk-value {
            font-size: 1.25rem;
            font-weight: 700;
            color: var(--risk-color);
        }

        .risk-band .risk-prob {
            font-size: 0.8125rem;
            font-weight: 500;
            color: var(--ink-mid);
            margin-top: 5px;
        }

        /* Category Breakdown */
        .category-breakdown {
            background: var(--white);
            border: 1px solid var(--border);
            border-radius: 16px;
            padding: 26px;
            margin-bottom: 25px;
        }

        .category-breakdown h3 {
            font-size: 0.9375rem;
            font-weight: 700;
            color: var(--ink);
            margin-bottom: 20px;
        }

        .category-item {
            margin-bottom: 18px;
        }

        .category-item:last-child {
            margin-bottom: 0;
        }

        .category-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 8px;
        }

        .category-name {
            font-size: 0.875rem;
            font-weight: 600;
            color: var(--ink);
        }

        .category-score {
            font-size: 0.8125rem;
            font-weight: 700;
            color: var(--ink-light);
        }

        .category-bar {
            height: 8px;
            background: var(--border);
            border-radius: 4px;
            overflow: hidden;
        }

        .category-fill {
            height: 100%;
            border-radius: 4px;
            transition: width 0.6s ease;
        }

        /* Priority Gaps */
        .priority-gaps {
            background: var(--white);
            border: 1px solid var(--border);
            border-radius: 16px;
            padding: 26px;
            margin-bottom: 25px;
        }

        .priority-gaps h3 {
            font-size: 0.9375rem;
            font-weight: 700;
            color: var(--ink);
            margin-bottom: 20px;
        }

        .gap-item {
            display: flex;
            gap: 15px;
            padding: 16px;
            background: #fef2f2;
            border: 1px solid #fecaca;
            border-radius: 10px;
            margin-bottom: 12px;
        }

        .gap-item:last-child {
            margin-bottom: 0;
        }

        .gap-icon {
            width: 36px;
            height: 36px;
            background: var(--red);
            border-radius: 8px;
            display: flex;
            align-items: center;
            justify-content: center;
            flex-shrink: 0;
            color: #fff;
            font-weight: 700;
            font-size: 1rem;
        }

        .gap-content h4 {
            font-size: 0.9375rem;
            font-weight: 700;
            color: var(--ink);
            margin-bottom: 4px;
        }

        .gap-content p {
            font-size: 0.8125rem;
            font-weight: 500;
            color: var(--ink-mid);
            line-height: 1.5;
        }

        /* CTA Section */
        .cta-section {
            background: var(--white);
            border: 2px solid var(--accent);
            border-radius: 16px;
            padding: 32px;
            text-align: center;
        }

        .cta-section h3 {
            font-size: 1.25rem;
            font-weight: 700;
            color: var(--ink);
            margin-bottom: 10px;
            letter-spacing: -0.3px;
        }

        .cta-section p {
            color: var(--ink-mid);
            margin-bottom: 20px;
            max-width: 500px;
            margin-left: auto;
            margin-right: auto;
            font-size: 0.9375rem;
        }

        .cta-section .btn-primary {
            max-width: none;
            display: inline-block;
            padding: 16px 40px;
            font-size: 0.9375rem;
        }

        .cta-features {
            display: flex;
            justify-content: center;
            gap: 30px;
            margin-top: 20px;
            flex-wrap: wrap;
        }

        .cta-feature {
            display: flex;
            align-items: center;
            gap: 8px;
            font-size: 0.8125rem;
            font-weight: 500;
            color: var(--ink-mid);
        }

        .cta-feature span {
            color: var(--green);
            font-weight: 700;
        }

        /* What This Means */
        .explanation {
            background: var(--white);
            border: 1px solid var(--border);
            border-radius: 16px;
            padding: 26px;
            margin-bottom: 25px;
        }

        .explanation h3 {
            font-size: 0.9375rem;
            font-weight: 700;
            color: var(--ink);
            margin-bottom: 15px;
        }

        .explanation p {
            color: var(--ink-mid);
            font-size: 0.9375rem;
            line-height: 1.6;
            margin-bottom: 12px;
        }

        .explanation p:last-child {
            margin-bottom: 0;
        }

        /* Footer */
        .footer {
            background: var(--white);
            border-top: 1px solid var(--border);
            padding: 22px 0;
            margin-top: 36px;
        }

        .footer-inner {
            max-width: 1080px;
            margin: 0 auto;
            padding: 0 24px;
            display: flex;
            justify-content: space-between;
            font-size: 0.75rem;
            font-weight: 500;
            color: var(--ink-light);
        }

        .footer a {
            color: var(--ink-mid);
            text-decoration: none;
            margin-left: 20px;
        }

        .footer a:hover {
            color: var(--accent);
        }

        /* Modal */
        .modal-overlay {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: rgba(0, 0, 0, 0.6);
            z-index: 1000;
            align-items: center;
            justify-content: center;
            padding: 20px;
        }

        .modal-overlay.active {
            display: flex;
        }

        .modal {
            background: var(--white);
            border: 1px solid var(--border);
            border-radius: 16px;
            padding: 40px;
            max-width: 500px;
            width: 100%;
            position: relative;
            animation: modalIn 0.3s ease;
            box-shadow: 0 20px 60px rgba(0, 0, 0, 0.3);
        }

        @keyframes modalIn {
            from { opacity: 0; transform: scale(0.95); }
            to { opacity: 1; transform: scale(1); }
        }

        .modal-close {
            position: absolute;
            top: 15px;
            right: 20px;
            background: none;
            border: none;
            color: var(--ink-light);
            font-size: 1.8rem;
            cursor: pointer;
            transition: color 0.2s;
        }

        .modal-close:hover {
            color: var(--ink);
        }

        .modal h2 {
            font-size: 1.5rem;
            font-weight: 700;
            color: var(--ink);
            margin-bottom: 10px;
            letter-spacing: -0.3px;
        }

        .modal > p {
            color: var(--ink-mid);
            margin-bottom: 25px;
        }

        .modal-note {
            text-align: center;
            font-size: 0.8125rem;
            font-weight: 500;
            color: var(--ink-light);
            margin-top: 15px;
            margin-bottom: 0;
        }

        .form-group textarea {
            width: 100%;
            padding: 12px 14px;
            background: var(--white);
            border: 1px solid var(--border);
            border-radius: 10px;
            color: var(--ink);
            font-family: inherit;
            font-size: 0.9375rem;
            font-weight: 500;
            transition: all 0.2s ease;
            resize: vertical;
        }

        .form-group textarea:focus {
            outline: none;
            border-color: var(--accent);
            box-shadow: 0 0 0 3px rgba(14, 165, 233, 0.15);
        }

        .form-group textarea::placeholder {
            color: var(--ink-light);
        }

        /* Thank You Modal */
        .thank-you-modal {
            text-align: center;
        }

        .thank-you-icon {
            width: 70px;
            height: 70px;
            background: var(--green);
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 2rem;
            color: #fff;
            margin: 0 auto 20px;
        }

        .score-reminder {
            background: var(--bg);
            padding: 12px 20px;
            border-radius: 10px;
            margin: 20px 0;
            color: var(--ink-mid);
            font-size: 0.9375rem;
        }

        .score-reminder strong {
            color: var(--ink);
            font-weight: 700;
        }

        /* Intro Section */
        .intro {
            display: block;
        }

        .intro.hidden {
            display: none;
        }

        .intro-card {
            background: var(--white);
            border: 1px solid var(--border);
            border-radius: 16px;
            padding: 40px;
            text-align: center;
        }

        .intro-card h2 {
            font-size: 1.5rem;
            font-weight: 700;
            color: var(--ink);
            margin-bottom: 15px;
            letter-spacing: -0.3px;
        }

        .intro-card p {
            color: var(--ink-mid);
            font-size: 0.9375rem;
            margin-bottom: 25px;
            max-width: 550px;
            margin-left: auto;
            margin-right: auto;
        }

        .intro-features {
            display: grid;
            grid-template-columns: repeat(3, 1fr);
            gap: 20px;
            margin: 30px 0;
            text-align: left;
        }

        @media (max-width: 600px) {
            .intro-features {
                grid-template-columns: 1fr;
            }
        }

        .intro-feature {
            background: var(--bg);
            border-radius: 10px;
            padding: 20px;
        }

        .intro-feature h4 {
            font-size: 0.9375rem;
            font-weight: 700;
            color: var(--ink);
            margin-bottom: 8px;
        }

        .intro-feature p {
            font-size: 0.8125rem;
            font-weight: 500;
            color: var(--ink-mid);
            margin: 0;
        }

        .intro-card .btn-primary {
            max-width: none;
            display: inline-block;
            padding: 16px 50px;
            font-size: 0.9375rem;
        }

        .intro-note {
            margin-top: 20px;
            font-size: 0.8125rem;
            font-weight: 500;
            color: var(--ink-light);
        }

        @media print {
            .header, .footer, .nav-buttons, .cta-section { display: none; }
            .hero { padding: 20px; }
        }
    </style>
</head>
<body>
    <!-- Header -->
    <header class="header">
        <div class="header-inner">
            <img src="logo.png" alt="QuantiveCyber" class="logo" onerror="this.style.display='none'">
            <div class="brand-info">
                <div class="brand-name">QuantiveCyber</div>
                <div class="brand-tagline">Security you can measure</div>
            </div>
        </div>
    </header>

    <!-- Hero -->
    <div class="hero">
        <h1>AI Readiness Check</h1>
        <p>Find out if your organisation is ready to safely adopt AI tools like Microsoft Copilot</p>
    </div>

    <div class="container">

        <!-- Intro Section -->
        <div class="intro" id="intro">
            <div class="intro-card">
                <h2>Is Your Business Ready for AI?</h2>
                <p>Take our free 5-minute assessment to understand your organisation's readiness to safely deploy AI tools like Microsoft Copilot.</p>
                
                <div class="intro-features">
                    <div class="intro-feature">
                        <h4>13 Questions</h4>
                        <p>Quick assessment covering 6 critical areas</p>
                    </div>
                    <div class="intro-feature">
                        <h4>Instant Score</h4>
                        <p>See your AI readiness score out of 100</p>
                    </div>
                    <div class="intro-feature">
                        <h4>Gap Analysis</h4>
                        <p>Identify your top priority areas</p>
                    </div>
                </div>

                <button class="btn btn-primary" onclick="startAssessment()">Start Assessment</button>
                <p class="intro-note">No sign-up required • Takes about 5 minutes</p>
            </div>
        </div>

        <!-- Progress -->
        <div class="progress-container" id="progressContainer" style="display: none;">
            <div class="progress-bar" id="progressBar"></div>
        </div>
        <div class="progress-text" id="progressText" style="display: none;">Question 1 of 13</div>

        <!-- Questions -->
        <div id="questionsContainer"></div>

        <!-- Lead Capture Modal -->
        <div class="modal-overlay" id="modalOverlay">
            <div class="modal">
                <button class="modal-close" onclick="closeModal()">×</button>
                <h2>Book Your Full Assessment</h2>
                <p>Enter your details and we'll be in touch to schedule your comprehensive 43-point technical assessment.</p>
                
                <div class="form-row">
                    <div class="form-group">
                        <label>First Name *</label>
                        <input type="text" id="firstName" placeholder="John" required>
                    </div>
                    <div class="form-group">
                        <label>Last Name *</label>
                        <input type="text" id="lastName" placeholder="Smith" required>
                    </div>
                </div>
                
                <div class="form-group">
                    <label>Work Email *</label>
                    <input type="email" id="email" placeholder="john@company.com" required>
                </div>
                
                <div class="form-group">
                    <label>Company Name *</label>
                    <input type="text" id="company" placeholder="Acme Ltd" required>
                </div>
                
                <div class="form-row">
                    <div class="form-group">
                        <label>Number of Employees</label>
                        <select id="employees">
                            <option value="">Select...</option>
                            <option value="1-50">1-50</option>
                            <option value="51-100">51-100</option>
                            <option value="101-250">101-250</option>
                            <option value="251-500">251-500</option>
                            <option value="500+">500+</option>
                        </select>
                    </div>
                    <div class="form-group">
                        <label>Industry</label>
                        <select id="industry">
                            <option value="">Select...</option>
                            <option value="Financial Services">Financial Services</option>
                            <option value="Legal">Legal</option>
                            <option value="Healthcare">Healthcare</option>
                            <option value="Professional Services">Professional Services</option>
                            <option value="Technology">Technology</option>
                            <option value="Manufacturing">Manufacturing</option>
                            <option value="Retail">Retail</option>
                            <option value="Other">Other</option>
                        </select>
                    </div>
                </div>

                <div class="form-group">
                    <label>Anything else you'd like us to know?</label>
                    <textarea id="notes" placeholder="E.g., specific concerns, timeline, questions..." rows="3"></textarea>
                </div>

                <button class="btn btn-primary" onclick="submitLead()" style="width: 100%; max-width: none;">Submit Request →</button>
                
                <p class="modal-note">We'll respond within 1 business day</p>
            </div>
        </div>
        
        <!-- Thank You Modal -->
        <div class="modal-overlay" id="thankYouModal">
            <div class="modal thank-you-modal">
                <div class="thank-you-icon">✓</div>
                <h2>Thank You!</h2>
                <p>We've received your request and will be in touch within 1 business day to schedule your full assessment.</p>
                <p class="score-reminder">Your self-assessment score: <strong id="finalScoreReminder">0</strong>/100</p>
                <button class="btn btn-primary" onclick="closeThankYou()" style="max-width: none;">Close</button>
            </div>
        </div>

        <!-- Results Section -->
        <div class="results" id="results">
            <div class="results-header">
                <h2>Your AI Readiness Results</h2>
                <p id="resultsIntro"></p>
            </div>

            <div class="score-display">
                <div class="score-circle" id="scoreCircle">
                    <span class="score-value" id="scoreValue">0</span>
                    <span class="score-label">out of 100</span>
                </div>
                <div class="risk-band" id="riskBand">
                    <div class="risk-label">Risk Level</div>
                    <div class="risk-value" id="riskValue">—</div>
                    <div class="risk-prob" id="riskProb"></div>
                </div>
            </div>

            <div class="explanation" id="explanation">
                <h3>What This Means</h3>
                <p id="explanationText"></p>
            </div>

            <div class="category-breakdown">
                <h3>Category Breakdown</h3>
                <div id="categoryBreakdown"></div>
            </div>

            <div class="priority-gaps" id="priorityGaps">
                <h3>Your Priority Gaps</h3>
                <div id="gapsList"></div>
            </div>

            <div class="cta-section">
                <h3>Ready for the Full Picture?</h3>
                <p>This self-assessment gives you an indication. Our full technical assessment examines 43 controls in your Microsoft 365 tenant to give you a precise score and implementation roadmap.</p>
                <button class="btn btn-primary" onclick="openModal()">Book Your Full Assessment →</button>
                <div class="cta-features">
                    <div class="cta-feature"><span>✓</span> 43 technical tests</div>
                    <div class="cta-feature"><span>✓</span> Detailed report</div>
                    <div class="cta-feature"><span>✓</span> Implementation roadmap</div>
                </div>
            </div>
        </div>

    </div>

    <!-- Footer -->
    <footer class="footer">
        <div class="footer-inner">
            <span>© 2025 QuantiveCyber. For planning purposes only.</span>
            <div>
                <a href="https://quantivecyber.com">Website</a>
                <a href="mailto:hello@quantivecyber.com">Contact</a>
            </div>
        </div>
    </footer>

    <script>
        // Questions data
        const questions = [
            {
                id: 1,
                category: "Data Visibility",
                categoryWeight: 15,
                text: "Do you know where all your sensitive business data is stored across Microsoft 365?",
                options: [
                    { text: "Yes, we have a complete picture of where our data resides", points: 1 },
                    { text: "Partially, we know some locations but not all", points: 0.5 },
                    { text: "No, data is spread across many places and we don't have full visibility", points: 0 }
                ]
            },
            {
                id: 2,
                category: "Data Visibility",
                categoryWeight: 15,
                text: "Do you have visibility into which cloud apps and AI tools your employees are using?",
                options: [
                    { text: "Yes, we monitor and control cloud app usage", points: 1 },
                    { text: "We have some visibility but gaps exist", points: 0.5 },
                    { text: "No, we don't actively track this", points: 0 }
                ]
            },
            {
                id: 3,
                category: "Identity & Access",
                categoryWeight: 22,
                text: "Is multi-factor authentication (MFA) enforced for all users in your organisation?",
                options: [
                    { text: "Yes, MFA is required for everyone", points: 1 },
                    { text: "For administrators and some users only", points: 0.5 },
                    { text: "No, or only for a small number of users", points: 0 }
                ]
            },
            {
                id: 4,
                category: "Identity & Access",
                categoryWeight: 22,
                text: "Do you conduct regular reviews of who has access to sensitive data, sites, and groups?",
                options: [
                    { text: "Yes, we review access at least quarterly", points: 1 },
                    { text: "Occasionally, but not on a regular schedule", points: 0.5 },
                    { text: "No formal access reviews are conducted", points: 0 }
                ]
            },
            {
                id: 5,
                category: "Identity & Access",
                categoryWeight: 22,
                text: "How many Global Administrators do you have in Microsoft 365?",
                options: [
                    { text: "2-4 (best practice)", points: 1 },
                    { text: "5-8", points: 0.5 },
                    { text: "More than 8, or I don't know", points: 0 }
                ]
            },
            {
                id: 6,
                category: "Data Classification",
                categoryWeight: 20,
                text: "Do you use sensitivity labels to classify documents and emails (e.g., Confidential, Internal, Public)?",
                options: [
                    { text: "Yes, labels are deployed and actively used across the organisation", points: 1 },
                    { text: "Labels exist but are rarely used or only by some teams", points: 0.5 },
                    { text: "No sensitivity labels are configured", points: 0 }
                ]
            },
            {
                id: 7,
                category: "Data Classification",
                categoryWeight: 20,
                text: "Do you have Data Loss Prevention (DLP) policies to prevent sensitive data being shared inappropriately?",
                options: [
                    { text: "Yes, DLP policies are active across email, files, and Teams", points: 1 },
                    { text: "Some DLP policies exist but coverage is limited", points: 0.5 },
                    { text: "No DLP policies are configured", points: 0 }
                ]
            },
            {
                id: 8,
                category: "Device Security",
                categoryWeight: 5,
                text: "Are company devices managed and required to meet security standards before accessing company data?",
                options: [
                    { text: "Yes, all devices are enrolled and must be compliant", points: 1 },
                    { text: "Some devices are managed, but not all", points: 0.5 },
                    { text: "No device management in place", points: 0 }
                ]
            },
            {
                id: 9,
                category: "Collaboration Security",
                categoryWeight: 15,
                text: "Is external file sharing from SharePoint and OneDrive restricted or controlled?",
                options: [
                    { text: "Yes, sharing requires approval or is limited to specific domains", points: 1 },
                    { text: "Some restrictions exist but it's fairly open", points: 0.5 },
                    { text: "No restrictions — anyone can share externally", points: 0 }
                ]
            },
            {
                id: 10,
                category: "Collaboration Security",
                categoryWeight: 15,
                text: "Could an employee potentially access sensitive data (HR, Finance, Legal) that isn't relevant to their role?",
                options: [
                    { text: "No, access is tightly controlled based on role and need", points: 1 },
                    { text: "Possibly, we haven't audited permissions recently", points: 0.5 },
                    { text: "Probably yes, permissions are quite broad", points: 0 }
                ]
            },
            {
                id: 11,
                category: "AI Readiness",
                categoryWeight: 0,
                text: "Are you currently using or planning to deploy Microsoft Copilot or other AI tools?",
                isContext: true,
                options: [
                    { text: "Yes, we're actively using or deploying soon", points: 0 },
                    { text: "Planning to within the next 12 months", points: 0 },
                    { text: "No plans currently", points: 0 }
                ]
            },
            {
                id: 12,
                category: "AI Governance",
                categoryWeight: 23,
                text: "Do you have policies or technical controls around employees using external AI tools like ChatGPT?",
                options: [
                    { text: "Yes, we block or actively control external AI tool usage", points: 1 },
                    { text: "We have guidelines but no technical enforcement", points: 0.5 },
                    { text: "No policies or controls in place", points: 0 }
                ]
            },
            {
                id: 13,
                category: "AI Governance",
                categoryWeight: 23,
                text: "Have you conducted an audit to identify data that might be over-shared before deploying AI?",
                options: [
                    { text: "Yes, we've reviewed and remediated permissions", points: 1 },
                    { text: "We're aware of the risk but haven't completed an audit", points: 0.5 },
                    { text: "No, we haven't considered this", points: 0 }
                ]
            }
        ];

        // State
        let currentQuestion = 0;
        let answers = {};
        let aiPlanningContext = '';

        // Category mapping for scoring
        const categoryConfig = {
            "Data Visibility": { maxPoints: 15, questions: [1, 2] },
            "Identity & Access": { maxPoints: 22, questions: [3, 4, 5] },
            "Data Classification": { maxPoints: 20, questions: [6, 7] },
            "Device Security": { maxPoints: 5, questions: [8] },
            "Collaboration Security": { maxPoints: 15, questions: [9, 10] },
            "AI Governance": { maxPoints: 23, questions: [12, 13] }
        };

        // Gap descriptions
        const gapDescriptions = {
            "Data Visibility": {
                title: "Limited Data Visibility",
                description: "You may not have full visibility into where sensitive data resides. AI tools could access data you're not aware of."
            },
            "Identity & Access": {
                title: "Access Control Gaps", 
                description: "Weak identity controls increase the risk of AI tools accessing data through compromised or over-privileged accounts."
            },
            "Data Classification": {
                title: "Insufficient Data Protection",
                description: "Without proper classification and DLP, sensitive data may not be protected when AI tools process it."
            },
            "Device Security": {
                title: "Device Security Gaps",
                description: "Unmanaged devices could be used to access AI tools without proper security controls."
            },
            "Collaboration Security": {
                title: "Oversharing Risk",
                description: "Broad permissions mean AI tools could surface sensitive data to users who shouldn't see it, the #1 Copilot risk."
            },
            "AI Governance": {
                title: "No AI Governance",
                description: "Without AI-specific controls, you have no visibility or protection over how AI tools interact with your data."
            }
        };

        function startAssessment() {
            document.getElementById('intro').classList.add('hidden');
            document.getElementById('progressContainer').style.display = 'block';
            document.getElementById('progressText').style.display = 'block';
            renderQuestion();
        }

        function renderQuestion() {
            const container = document.getElementById('questionsContainer');
            container.innerHTML = '';

            const q = questions[currentQuestion];
            
            const card = document.createElement('div');
            card.className = 'question-card active';
            
            card.innerHTML = `
                <span class="category-badge">${q.category}</span>
                <div class="question-number">Question ${currentQuestion + 1} of ${questions.length}</div>
                <div class="question-text">${q.text}</div>
                <div class="options">
                    ${q.options.map((opt, i) => `
                        <div class="option ${answers[q.id] === i ? 'selected' : ''}" onclick="selectOption(${q.id}, ${i})">
                            <div class="option-indicator"></div>
                            <div class="option-text">${opt.text}</div>
                        </div>
                    `).join('')}
                </div>
                <div class="nav-buttons">
                    ${currentQuestion > 0 ? '<button class="btn btn-secondary" onclick="prevQuestion()">← Back</button>' : '<div></div>'}
                    <button class="btn btn-primary" id="nextBtn" onclick="nextQuestion()" ${answers[q.id] === undefined ? 'disabled' : ''}>
                        ${currentQuestion === questions.length - 1 ? 'Continue →' : 'Next →'}
                    </button>
                </div>
            `;
            
            container.appendChild(card);
            updateProgress();
        }

        function selectOption(questionId, optionIndex) {
            answers[questionId] = optionIndex;
            
            // Store AI planning context
            if (questionId === 11) {
                aiPlanningContext = questions[10].options[optionIndex].text;
            }
            
            // Update UI
            document.querySelectorAll('.option').forEach((opt, i) => {
                opt.classList.toggle('selected', i === optionIndex);
            });
            document.getElementById('nextBtn').disabled = false;
        }

        function nextQuestion() {
            if (currentQuestion < questions.length - 1) {
                currentQuestion++;
                renderQuestion();
            } else {
                showResults();
            }
        }

        function prevQuestion() {
            if (currentQuestion > 0) {
                currentQuestion--;
                renderQuestion();
            }
        }

        function updateProgress() {
            const progress = ((currentQuestion + 1) / questions.length) * 100;
            document.getElementById('progressBar').style.width = progress + '%';
            document.getElementById('progressText').textContent = `Question ${currentQuestion + 1} of ${questions.length}`;
        }

        function openModal() {
            document.getElementById('modalOverlay').classList.add('active');
            document.body.style.overflow = 'hidden';
        }

        function closeModal() {
            document.getElementById('modalOverlay').classList.remove('active');
            document.body.style.overflow = '';
        }

        function closeThankYou() {
            document.getElementById('thankYouModal').classList.remove('active');
            document.body.style.overflow = '';
        }

        async function submitLead() {
            // Validate form
            const firstName = document.getElementById('firstName').value.trim();
            const lastName = document.getElementById('lastName').value.trim();
            const email = document.getElementById('email').value.trim();
            const company = document.getElementById('company').value.trim();

            if (!firstName || !lastName || !email || !company) {
                alert('Please fill in all required fields');
                return;
            }

            // Get score for the lead data
            const { categoryScores, totalScore } = calculateScores();

            // Format category scores for email
            let categoryBreakdown = '';
            for (const [category, data] of Object.entries(categoryScores)) {
                categoryBreakdown += `${category}: ${data.score}/${data.max} (${data.percentage}%)\n`;
            }

            // Prepare form data
            const formData = {
                access_key: "1ad1c73a-e8b9-4fe6-aedb-9cc1813d7dcf",
                subject: `New AI Readiness Check Lead - ${company} (Score: ${totalScore}/100)`,
                from_name: `${firstName} ${lastName}`,
                email: email,
                company: company,
                employees: document.getElementById('employees').value || 'Not specified',
                industry: document.getElementById('industry').value || 'Not specified',
                notes: document.getElementById('notes').value || 'None',
                total_score: `${totalScore}/100`,
                category_breakdown: categoryBreakdown,
                ai_planning: aiPlanningContext,
                timestamp: new Date().toISOString()
            };

            try {
                const response = await fetch('https://api.web3forms.com/submit', {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json'
                    },
                    body: JSON.stringify(formData)
                });

                const result = await response.json();

                if (result.success) {
                    // Close form modal, show thank you
                    closeModal();
                    document.getElementById('finalScoreReminder').textContent = totalScore;
                    document.getElementById('thankYouModal').classList.add('active');
                } else {
                    alert('There was an error submitting your request. Please try again.');
                    console.error('Form submission error:', result);
                }
            } catch (error) {
                alert('There was an error submitting your request. Please try again.');
                console.error('Form submission error:', error);
            }
        }

        function calculateScores() {
            const categoryScores = {};
            
            for (const [category, config] of Object.entries(categoryConfig)) {
                let totalPoints = 0;
                let questionCount = 0;
                
                config.questions.forEach(qNum => {
                    const q = questions.find(question => question.id === qNum);
                    if (q && answers[qNum] !== undefined) {
                        totalPoints += q.options[answers[qNum]].points;
                        questionCount++;
                    }
                });
                
                const avgScore = questionCount > 0 ? totalPoints / questionCount : 0;
                categoryScores[category] = {
                    score: Math.round(avgScore * config.maxPoints),
                    max: config.maxPoints,
                    percentage: Math.round(avgScore * 100)
                };
            }
            
            const totalScore = Object.values(categoryScores).reduce((sum, cat) => sum + cat.score, 0);
            
            return { categoryScores, totalScore };
        }

        function getRiskBand(score) {
            if (score <= 35) {
                return {
                    label: 'Critical Risk',
                    color: '#ef4444',
                    colorDark: '#dc2626',
                    probability: '30-40% annual incident probability',
                    explanation: "Your organisation has significant gaps in AI readiness. Deploying AI tools like Copilot in this state would expose sensitive data to serious risks. Immediate action is recommended before any AI adoption."
                };
            } else if (score <= 70) {
                return {
                    label: 'Elevated Risk',
                    color: '#f59e0b',
                    colorDark: '#d97706',
                    probability: '15-25% annual incident probability',
                    explanation: "You have some foundations in place, but notable gaps remain. AI tools could be deployed with caution, but you should address the priority areas identified below to reduce your risk exposure."
                };
            } else {
                return {
                    label: 'Managed Risk',
                    color: '#10b981',
                    colorDark: '#059669',
                    probability: '5-10% annual incident probability',
                    explanation: "Good news. You have solid foundations for AI adoption. There may still be optimisation opportunities, but your organisation is well-positioned to deploy AI tools safely."
                };
            }
        }

        function showResults() {
            // Hide question elements
            document.getElementById('questionsContainer').innerHTML = '';
            document.getElementById('progressContainer').style.display = 'none';
            document.getElementById('progressText').style.display = 'none';

            // Calculate scores
            const { categoryScores, totalScore } = calculateScores();
            const risk = getRiskBand(totalScore);

            // Show results
            const resultsDiv = document.getElementById('results');
            resultsDiv.classList.add('active');

            // Set score
            document.getElementById('scoreValue').textContent = totalScore;
            document.getElementById('resultsIntro').textContent = `Here's your AI Readiness assessment`;

            // Set risk band colors
            document.documentElement.style.setProperty('--risk-color', risk.color);
            document.documentElement.style.setProperty('--risk-color-dark', risk.colorDark);
            document.getElementById('scoreCircle').style.setProperty('--risk-color', risk.color);
            document.getElementById('scoreCircle').style.setProperty('--risk-color-dark', risk.colorDark);
            document.getElementById('riskBand').style.setProperty('--risk-color', risk.color);
            document.getElementById('riskBand').style.borderColor = risk.color;
            document.getElementById('riskValue').textContent = risk.label;
            document.getElementById('riskValue').style.color = risk.color;
            document.getElementById('riskProb').textContent = risk.probability;

            // Explanation
            document.getElementById('explanationText').textContent = risk.explanation;

            // Category breakdown
            const breakdownDiv = document.getElementById('categoryBreakdown');
            breakdownDiv.innerHTML = '';
            
            const categoryColors = {
                "Data Visibility": "#0ea5e9",
                "Identity & Access": "#8b5cf6",
                "Data Classification": "#06b6d4",
                "Device Security": "#10b981",
                "Collaboration Security": "#f59e0b",
                "AI Governance": "#ef4444"
            };

            for (const [category, data] of Object.entries(categoryScores)) {
                const percentage = (data.score / data.max) * 100;
                const color = categoryColors[category] || "#3b82f6";
                
                breakdownDiv.innerHTML += `
                    <div class="category-item">
                        <div class="category-header">
                            <span class="category-name">${category}</span>
                            <span class="category-score">${data.score}/${data.max}</span>
                        </div>
                        <div class="category-bar">
                            <div class="category-fill" style="width: ${percentage}%; background: ${color};"></div>
                        </div>
                    </div>
                `;
            }

            // Priority gaps (lowest scoring categories)
            const sortedCategories = Object.entries(categoryScores)
                .map(([name, data]) => ({ name, ...data, pct: data.score / data.max }))
                .sort((a, b) => a.pct - b.pct)
                .filter(cat => cat.pct < 0.7)
                .slice(0, 3);

            const gapsDiv = document.getElementById('gapsList');
            if (sortedCategories.length === 0) {
                document.getElementById('priorityGaps').style.display = 'none';
            } else {
                gapsDiv.innerHTML = '';
                sortedCategories.forEach((cat, i) => {
                    const gap = gapDescriptions[cat.name];
                    gapsDiv.innerHTML += `
                        <div class="gap-item">
                            <div class="gap-icon">${i + 1}</div>
                            <div class="gap-content">
                                <h4>${gap.title}</h4>
                                <p>${gap.description}</p>
                            </div>
                        </div>
                    `;
                });
            }

            // Scroll to top
            window.scrollTo({ top: 0, behavior: 'smooth' });
        }
    </script>
</body>
</html>
